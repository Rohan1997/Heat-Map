This is the final working code
